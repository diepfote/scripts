#!/usr/bin/env bash

trap cleanup EXIT
cleanup () { set +x; }

sys="$(uname)"
exe=/usr/bin/ffmpeg

if [ "$sys" = Darwin ]; then
  exe=/opt/homebrew/bin/ffmpeg
fi

# -y ... always override
# --preset slow ... increases encoding time but
#                   improves output quality and
#                   reduces file size
extra_args=(-preset slow -y)
if [ -n "${FFMPEG_NO_WRAPPER:-}" ]; then
  extra_args=()
fi

set -x
"$exe" "${extra_args[@]}" "$@"

