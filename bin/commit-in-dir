#!/usr/bin/env bash

trap "popd" EXIT

pushd "$1"
shift

git status -sb
echo -e '\n----------------\n'

message="$1"
shift

if [ $# -lt 1 ]; then
  git add .
else
  for path in "$@"; do
    git add "$path"
  done
fi
echo
[ -n "$message" ] && git commit -m "$message" \
  || git commit
echo -e '\n----------------\n'

git status -sb
echo -e '\n----------------\n'

source ~/.sh_functions
git --no-pager l -2 --stat
echo -e '\n----------------\n'

sleep 2
git push

